# PRD.yml — Structured Mini-PRD (for task management & traceability)
#
# This is the STRUCTURED, machine-readable version of the PRD.
# For the FULL prose PRD, see: .seedgpt/prd.md
#
# CROSS-REFERENCE SCHEMA:
#   PRD-###           → PRD Requirement ID
#   roadmap_ref       → Link to roadmap item (RM-{version}-###)
#   sprint_refs       → Links to sprint tasks implementing this (SP-###-###)

project:
  name: "Moltbot Work — AI Agent Infrastructure Ecosystem"
  description: >
    A collection of production-ready infrastructure services for AI agents:
    MoltBank (payments/wallets), MoltCredit (trust/credit), AgentMail (email),
    and MoltPhone (voice calls). Currently naive prototypes, to be rebuilt as
    full-stack production applications.
  goals:
    - Transform static landing pages into production APIs
    - Implement real backend services with databases
    - Create unified agent authentication across services
    - Deploy to production with proper operations
    - Enable agent-to-agent commerce and communication
    - Build user-facing webapps for each service
    - Update landing pages with live product links
  non_goals:
    - Real cryptocurrency/blockchain integration (simulated only)
    - Financial regulatory compliance
    - Mobile applications
    - Rebuilding SeedGpt (configure only)

features:
  - id: PRD-001
    name: "Shared Backend Infrastructure"
    description: "Common Node.js/TypeScript backend structure shared across all Molt services"
    acceptance_criteria:
      - "TypeScript project structure with shared utilities"
      - "Express or Fastify-based API framework"
      - "PostgreSQL database connection pooling"
      - "API key authentication middleware"
      - "Request logging and error handling"
    priority: high
    status: complete
    roadmap_ref: RM-v0-001
    sprint_refs: [SP-V01-001, SP-V01-002, SP-V01-004, SP-V01-005]

  - id: PRD-002
    name: "Agent Registration System"
    description: "Unified agent registration that works across all Molt services"
    acceptance_criteria:
      - "POST /register endpoint accepts handle, name, optional metadata"
      - "Returns API key on successful registration"
      - "API key validates across all services"
      - "Agent profiles stored in database"
    priority: high
    status: complete
    roadmap_ref: RM-v0-002
    sprint_refs: [SP-V02-001, SP-V07-002, SP-V07-005]

  - id: PRD-003
    name: "MoltBank Wallet API"
    description: "USDC wallet management for AI agents"
    acceptance_criteria:
      - "GET /wallet returns balance and transaction history"
      - "POST /wallet/deposit adds funds (simulated)"
      - "POST /wallet/transfer sends to other agents"
      - "Balance tracking with double-entry accounting"
    priority: high
    status: complete
    roadmap_ref: RM-v0-003
    sprint_refs: [SP-V02-002, SP-V02-004, SP-V03-004, SP-V07-001, SP-V07-003]

  - id: PRD-004
    name: "MoltBank Escrow System"
    description: "Escrow service for secure agent-to-agent payments"
    acceptance_criteria:
      - "POST /escrow/create locks funds with counterparty"
      - "POST /escrow/{id}/release releases to counterparty"
      - "POST /escrow/{id}/dispute initiates dispute"
      - "Escrow states: active, released, disputed, cancelled"
    priority: high
    status: complete
    roadmap_ref: RM-v0-004
    sprint_refs: [SP-V02-003, SP-V03-004]

  - id: PRD-005
    name: "MoltCredit Credit Lines"
    description: "Trust-based credit extension between agents"
    acceptance_criteria:
      - "POST /credit/extend creates credit line with limit"
      - "GET /credit shows incoming/outgoing credit lines"
      - "POST /transact records transactions against credit"
      - "Balance tracking with credit limit enforcement"
      - "Trust score calculation based on repayment history"
    priority: medium
    status: complete
    roadmap_ref: RM-v0-005
    sprint_refs: [SP-V04-001, SP-V04-002, SP-V04-003, SP-V04-004, SP-V04-005, SP-V04-006, SP-V04-009, SP-V07-001, SP-V07-003]

  - id: PRD-006
    name: "AgentMail Email Service"
    description: "Email infrastructure for AI agents"
    acceptance_criteria:
      - "Agent registration provisions @agentmail.xyz address"
      - "POST /send endpoint sends emails"
      - "GET /inbox returns received emails"
      - "Webhook delivery for incoming mail"
    priority: medium
    status: complete
    roadmap_ref: RM-v1-001
    sprint_refs: [SP-V05-001, SP-V05-002, SP-V05-003, SP-V05-004, SP-V05-005, SP-V05-006, SP-V05-007, SP-V05-010]

  - id: PRD-007
    name: "MoltPhone Voice API"
    description: "Voice call capabilities via Vapi integration"
    acceptance_criteria:
      - "POST /call initiates outbound call with AI"
      - "GET /calls returns call history"
      - "Webhook callbacks for call completion"
      - "Transcript storage and retrieval"
    priority: medium
    status: complete
    roadmap_ref: RM-v1-002
    sprint_refs: [SP-V06-001, SP-V06-002, SP-V06-003, SP-V06-004, SP-V06-005, SP-V06-006, SP-V06-009]

  - id: PRD-008
    name: "Production Deployment"
    description: "Deploy all services to production infrastructure"
    acceptance_criteria:
      - "Docker containers for all services"
      - "Cloud Run deployment configuration"
      - "Environment variable management"
      - "Health check endpoints"
      - "Logging to cloud logging service"
    priority: high
    status: complete
    roadmap_ref: RM-v0-006
    sprint_refs: [SP-V03-001, SP-V03-002, SP-V04-005, SP-V05-006, SP-V06-005, SP-V07-007, SP-V08-006]

  - id: PRD-009
    name: "API Documentation"
    description: "OpenAPI documentation for all endpoints"
    acceptance_criteria:
      - "OpenAPI 3.0 spec for each service"
      - "Auto-generated API docs page"
      - "Example requests and responses"
    priority: medium
    status: complete
    roadmap_ref: RM-v0-007
    sprint_refs: [SP-V03-003, SP-V04-006, SP-V05-007, SP-V06-006]

  - id: PRD-010
    name: "Test Coverage"
    description: "Unit and integration tests for all services"
    acceptance_criteria:
      - "Unit tests for business logic"
      - "Integration tests for API endpoints"
      - "Test database setup/teardown"
      - "CI runs tests on PRs"
      - "E2E smoke tests across all services"
    priority: medium
    status: complete
    roadmap_ref: RM-v1-003
    sprint_refs: [SP-V04-009, SP-V05-010, SP-V06-009, SP-V08-003, SP-V08-004]

  - id: PRD-011
    name: "MoltCredit Webapp"
    description: "Web application for managing credit lines, trust scores, and transactions"
    acceptance_criteria:
      - "Login/register with API key"
      - "Dashboard showing credit lines given and received"
      - "Extend credit, draw, and repay forms"
      - "Trust score display"
      - "Transaction history per credit line"
    priority: medium
    status: complete
    roadmap_ref: RM-v1-004
    sprint_refs: [SP-V04-007]

  - id: PRD-012
    name: "AgentMail Webapp"
    description: "Web application for managing agent email: inbox, compose, sent, webhooks"
    acceptance_criteria:
      - "Login/register with API key"
      - "Inbox view with received emails"
      - "Compose and send email form"
      - "Sent folder view"
      - "Webhook management panel"
    priority: medium
    status: complete
    roadmap_ref: RM-v1-005
    sprint_refs: [SP-V05-008]

  - id: PRD-013
    name: "Landing Page Integration"
    description: "Update all landing pages to link to live webapps and API docs"
    acceptance_criteria:
      - "All landing pages link to live webapps"
      - "All landing pages link to API docs"
      - "Feature lists match real capabilities"
      - "Real product screenshots"
      - "Proper SEO meta tags"
    priority: low
    status: complete
    roadmap_ref: RM-v1-006
    sprint_refs: [SP-V03-005, SP-V04-008, SP-V05-009, SP-V06-008, SP-V08-005]

  - id: PRD-014
    name: "Production Hardening"
    description: "Security, rate limiting, and operational hardening for production"
    acceptance_criteria:
      - "Per-agent rate limiting on all services"
      - "API key rotation with grace period"
      - "Input validation audit (Zod schemas on all endpoints)"
      - "SQL injection prevention verified"
      - "Error tracking via Sentry"
    priority: medium
    status: complete
    roadmap_ref: RM-v1-007
    sprint_refs: [SP-V07-004, SP-V07-005, SP-V07-006, SP-V08-001, SP-V08-002]

constraints:
  - "Monorepo with all services in subdirectories"
  - "TypeScript for all backend code"
  - "PostgreSQL as primary database"
  - "GCP Cloud Run for deployment"
  - "Existing static HTML files to be preserved as documentation"

dependencies:
  - "PostgreSQL database (Cloud SQL or equivalent)"
  - "GCP Cloud Run for hosting"
  - "Vapi.ai for voice call integration (MoltPhone)"
  - "Email provider for AgentMail (Resend, Postmark, or equivalent)"

traceability:
  - prd_id: PRD-001
    roadmap_ref: RM-v0-001
    sprint_refs: [SP-V01-001, SP-V01-002, SP-V01-004, SP-V01-005]
    status: complete
  - prd_id: PRD-002
    roadmap_ref: RM-v0-002
    sprint_refs: [SP-V02-001, SP-V07-002, SP-V07-005]
    status: complete
  - prd_id: PRD-003
    roadmap_ref: RM-v0-003
    sprint_refs: [SP-V02-002, SP-V02-004, SP-V03-004, SP-V07-001, SP-V07-003]
    status: complete
  - prd_id: PRD-004
    roadmap_ref: RM-v0-004
    sprint_refs: [SP-V02-003, SP-V03-004]
    status: complete
  - prd_id: PRD-005
    roadmap_ref: RM-v0-005
    sprint_refs: [SP-V04-001, SP-V04-002, SP-V04-003, SP-V04-004, SP-V04-005, SP-V04-006, SP-V04-009, SP-V07-001, SP-V07-003]
    status: complete
  - prd_id: PRD-006
    roadmap_ref: RM-v1-001
    sprint_refs: [SP-V05-001, SP-V05-002, SP-V05-003, SP-V05-004, SP-V05-005, SP-V05-006, SP-V05-007, SP-V05-010]
    status: complete
  - prd_id: PRD-007
    roadmap_ref: RM-v1-002
    sprint_refs: [SP-V06-001, SP-V06-002, SP-V06-003, SP-V06-004, SP-V06-005, SP-V06-006, SP-V06-009]
    status: complete
  - prd_id: PRD-008
    roadmap_ref: RM-v0-006
    sprint_refs: [SP-V03-001, SP-V03-002, SP-V04-005, SP-V05-006, SP-V06-005, SP-V07-007, SP-V08-006]
    status: complete
  - prd_id: PRD-009
    roadmap_ref: RM-v0-007
    sprint_refs: [SP-V03-003, SP-V04-006, SP-V05-007, SP-V06-006]
    status: complete
  - prd_id: PRD-010
    roadmap_ref: RM-v1-003
    sprint_refs: [SP-V04-009, SP-V05-010, SP-V06-009, SP-V08-003, SP-V08-004]
    status: complete
  - prd_id: PRD-011
    roadmap_ref: RM-v1-004
    sprint_refs: [SP-V04-007]
    status: complete
  - prd_id: PRD-012
    roadmap_ref: RM-v1-005
    sprint_refs: [SP-V05-008]
    status: complete
  - prd_id: PRD-013
    roadmap_ref: RM-v1-006
    sprint_refs: [SP-V03-005, SP-V04-008, SP-V05-009, SP-V06-008, SP-V08-005]
    status: complete
  - prd_id: PRD-014
    roadmap_ref: RM-v1-007
    sprint_refs: [SP-V07-004, SP-V07-005, SP-V07-006, SP-V08-001, SP-V08-002]
    status: complete
